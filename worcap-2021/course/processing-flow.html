<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fluxo de Processamento dos dados do BDC &mdash; Brazil Data Cube</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/table_styling.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/bdc.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Dados de Entrada" href="data.html" />
    <link rel="prev" title="Cubos de dados de Observação da Terra" href="data-cube.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >
            <a href="../../index.html" class="icon icon-home"> Brazil Data Cube
            <img src="../../_static/logo-bdc.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Brazil Data Cube Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../products.html">BDC Data Products</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../applications.html">Services and Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../specifications.html">Specifications</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../jornada-merc-2023.html">XIII Jornada de Educação em Sensoriamento Remoto no Âmbito do Mercosul</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../worcap-2023.html">WORCAP 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../treinamento-2023.html">Treinamento PRODES 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sbsr-2023.html">SBSR 2023 - Simpósio Brasileiro de Sensoriamento Remoto</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../treinamento-2022.html">Treinamento BDC 2022</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../worcap-2021.html">WorCAP 2021 - Introdução ao STAC e WTSS</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../course-info.html">Informações sobre o curso</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/getting-started.html">Configurações no Kaggle</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../course.html">Introdução ao STAC e WTSS</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="intro-bdc.html">Introdução Brazil Data Cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="image-processing.html">Fundamentos sobre imagens</a></li>
<li class="toctree-l3"><a class="reference internal" href="data-cube.html">Cubos de dados de Observação da Terra</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Fluxo de Processamento dos dados do BDC</a></li>
<li class="toctree-l3"><a class="reference internal" href="data.html">Dados de Entrada</a></li>
<li class="toctree-l3"><a class="reference internal" href="notebooks.html">Notebooks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../ibge-2021.html">IBGE 2021 - Workshop Brazil Data Cube com IBGE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sbsr-2021.html">SBSR Interim 2021 - Simpósio Brasileiro de Sensoriamento Remoto</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../worcap-2020.html">WorCAP 2020 - Geoinformática com Aplicações de Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../datascience-2020.html">CAP-394 - Introdução a Data Science (2020)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">General Information:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Brazil Data Cube</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../worcap-2021.html">WorCAP 2021 - Introdução ao STAC e WTSS</a> &raquo;</li>
          <li><a href="../course.html">Introdução ao STAC e WTSS</a> &raquo;</li>
      <li>Fluxo de Processamento dos dados do BDC</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="data-cube.html" class="btn btn-neutral float-left" title="Cubos de dados de Observação da Terra" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="data.html" class="btn btn-neutral float-right" title="Dados de Entrada" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="fluxo-de-processamento-dos-dados-do-bdc">
<h1>Fluxo de Processamento dos dados do BDC<a class="headerlink" href="#fluxo-de-processamento-dos-dados-do-bdc" title="Permalink to this headline"></a></h1>
<div class="section" id="image-collection-builder">
<h2>Image Collection builder<a class="headerlink" href="#image-collection-builder" title="Permalink to this headline"></a></h2>
<p>Os cubos de dados do Brazil Data Cube são gerados utilizando uma ferramenta chamada <cite>Cube Builder</cite>. Entretanto, para que o <cite>Cube Builder</cite> possa atuar, é necessário a existência de coleções de imagens. Com esta finalidade, foi desenvolvido o <cite>Collection builder</cite>, que é responsável pela injestão e processamentos para gerar as coleções de imagens prontas para análise do BDC. Baseado nisso, a  <a class="reference internal" href="#fig-products-processing-flow"><span class="std std-numref">Figura 45</span></a> ilustra um diagrama contendo os procedimentos principais usados para gerar os produtos de dados do BDC.</p>
<div class="align-center figure align-default" id="fig-products-processing-flow">
<a class="reference internal image-reference" href="../../_images/bdc.png"><img alt="BDC Image collection ingestion and Data Cube generation" src="../../_images/bdc.png" style="width: 720px;" /></a>
<p class="caption"><span class="caption-number">Figure 45 - </span><span class="caption-text">Injestão de coleções de imagem BDC e geração de cubos de dados.</span><a class="headerlink" href="#fig-products-processing-flow" title="Permalink to this image"></a></p>
</div>
<p>As imagens utilizadas pelo BDC são obtidas a partir de provedores oficiais dos dados, por exemplo os dados Sentinel-2 são obtidos através do portal copernicus da ESA e os dados Landsat-8 são obtidos através da USGS.</p>
<div class="section" id="correcao-atmosferica">
<h3>Correção Atmosférica<a class="headerlink" href="#correcao-atmosferica" title="Permalink to this headline"></a></h3>
<p>Uma vez que os dados são baixados dos provedores oficiais de dados, é feito um processamento de correção atmosférica nos produtos, com finalidade de gerar produtos em nível de reflectância de superfície. A correção atmosférica é um procedimento que depende das características de cada sensor. Devido a isso, para cada sensor um processo diferente pode ser aplicado, por exeplo para imagens Sentinel-2/MSI esse procedimento é feito utilizando o processador Sen2cor <span id="id1">[<a class="reference internal" href="../../references.html#id10" title="Jérôme Louis, Vincent Debaecker, Bringfried Pflug, Magdalena Main-Knorn, Jakub Bieniarz, Uwe Mueller-Wilm, Enrico Cadau, and Ferran Gascon. Sentinel-2 SEN2COR: L2A processor for users. European Space Agency, (Special Publication) ESA SP, SP-740:9–13, 2016.">9</a>]</span>, enquanto que para imagens Landsat-8/OLI esse procedimento é feito utilizando LaSRC <span id="id2">[<a class="reference internal" href="../../references.html#id26" title="Eric Vermote, Chris Justice, Martin Claverie, and Belen Franch. Preliminary analysis of the performance of the Landsat 8/OLI land surface reflectance product. Remote Sensing of Environment, 185:46–56, 2016. URL: http://dx.doi.org/10.1016/j.rse.2016.04.008, doi:10.1016/j.rse.2016.04.008.">21</a>]</span> e para imagens CBERS-4/AWFI é feito utilizando o MS3 <span id="id3">[<a class="reference internal" href="../../references.html#id19" title="Marco Aurélio Oliveira da Silva and Alexandre Curvelo de Andrade. Geração de imagens de reflectância de um ponto de vista geométrico. Revista Brasileira de Geomática, 1(1):23, 2013. doi:10.3895/rbgeo.v1n1.5434.">4</a>]</span>. Uma vez que este processo é feito e os resultados são catalogados, Coleções de Reflectância de Superfície ficam disponíveis para serem utilizadas para gerar Cubos de Dados.</p>
</div>
<div class="section" id="mascaras-de-nuvens">
<h3>Máscaras de Nuvens<a class="headerlink" href="#mascaras-de-nuvens" title="Permalink to this headline"></a></h3>
<p>Algoritmos de máscaras de nuvens, podem ser utilizados para detectar áreas indesejadas nas imagens, como por exemplo, nuvens, sombras de nuvens e neve. Entretanto, eles também dependem do sensor no qual são aplicada. Com base nisso, para dados Sentinel-2, utiliza-se a máscara padrão gerada pelo Sen2cor, chamada SCL, para imagens Landsat-8 têm-se adotado o uso do Fmask (versão 4.2) <span id="id4">[<a class="reference internal" href="../../references.html#id17" title="Shi Qiu, Zhe Zhu, and Binbin He. Fmask 4.0: Improved cloud and cloud shadow detection in Landsats 4–8 and Sentinel-2 imagery. Remote Sensing of Environment, 231(May):111205, 2019. URL: https://doi.org/10.1016/j.rse.2019.05.024, doi:10.1016/j.rse.2019.05.024.">14</a>]</span> enquanto que para imagens CBERS-4 este processo é feito utilizando a máscara CMASK devido as poucas bandas espectrais que este sensor apresenta.</p>
</div>
</div>
<div class="section" id="data-cube-builder">
<h2>Data Cube Builder<a class="headerlink" href="#data-cube-builder" title="Permalink to this headline"></a></h2>
<p>Uma vez com as coleções de imagens, é possível gerar os cubos de dados. Entretanto é preciso definir uma grade para a geração desses produtos. Assim, no contexto do BDC foram elaboradas três grades.</p>
<div class="section" id="grades-bdc">
<h3>Grades BDC<a class="headerlink" href="#grades-bdc" title="Permalink to this headline"></a></h3>
<p>As grades BDC apresentam células de tamanho 1°x1.5°, 2°x3° e 4°x6°. Dependendo da resolução espacial de cada sensor, uma grade específica é utilizada para gerar seus cubos Cubos Sentinel-2/MSI são gerados usando células de 1°x1.5°, enquanto que cubos Landsat-8/OLI usam o tamanho 2°x3° tiles, e cubos CBERS-4/AWFI são gerados utilizando o tamanho 4°x6°. As grades foram geradas adotando como ponto semente de origem a intersecção entre a linha do Equador e o meridiano 54° oeste. Seguindo os padrões cartográficos definidos pelo Instituto Brasileiro de Geografia e Estatística (IBGE), com esse ponto inicial definido é possível gerar automáticamente outras células de tamanho correspondente em um plano cartesiano do sistema de projeção, neste caso seguindo um plano de coordenadas na projeção Albers Equal-Area Cônica. Para cada célula, os limites superiores encontra perfeitamente os limites inferior do vizinho acima, e os limites esquerdos encontram perfeitamento os limites direitos das células à esquerda. A relação hierárquica entre as diferentes grades BDC podem ser observadas na <a class="reference internal" href="#fig-products-bdc-grid"><span class="std std-numref">Figura 46</span></a>.</p>
<div class="align-center figure align-default" id="fig-products-bdc-grid">
<a class="reference internal image-reference" href="../../_images/bdc-grid-v1.png"><img alt="BDC Grid" src="../../_images/bdc-grid-v1.png" style="width: 720px;" /></a>
<p class="caption"><span class="caption-number">Figure 46 - </span><span class="caption-text">Grade BDC.</span><a class="headerlink" href="#fig-products-bdc-grid" title="Permalink to this image"></a></p>
</div>
<p>O datum SIRGAS-2000, planimétrico oficial do Brasil, é o sistema geodésico de referência. Em suma, a string PROJ para a grade BDC pode ser expressa por:</p>
<div class="math notranslate nohighlight">
\[\begin{split}crs: +proj=aea +lat\_0=-12 +lon\_0=-54 +lat\_1=-2 +lat\_2=-22 \\
+x\_0=5000000 +y\_0 = 10000000 +ellps=GRS80 +units=m +no\_defs.\end{split}\]</div>
</div>
<div class="section" id="warp">
<h3>Warp<a class="headerlink" href="#warp" title="Permalink to this headline"></a></h3>
<p>Para construir os cubos de dados, todas as imagens devem estar em um mesmo sistema de projeção, usando a mesma grade e possuirem a mesma resolução espacial. O <cite>Warp</cite> é o procedimento que faz essa padronização, como pode ser visto na <a class="reference internal" href="#fig-products-cube-builder"><span class="std std-numref">Figura 47</span></a>. Warp consiste em recortar e mosaicar espacialmente todas as imagens que sobrepõem uma célula comum da grade, para uma data específica. Este mosaico espacial é reprojetado para o sistema de referência e todas as bandas são reamostradas para uma resolução espacial determinada, geralmente adota-se a reamostragem bilinear, exceto para bandas de qualidade, em que adota-se a reamostragem por vizinho mais próximo para evitar mudanças nos valores originais da imagem.</p>
<div class="align-center figure align-default" id="fig-products-cube-builder">
<a class="reference internal image-reference" href="../../_images/cube-builder.png"><img alt="BDC Cube generation" src="../../_images/cube-builder.png" style="width: 720px;" /></a>
<p class="caption"><span class="caption-number">Figure 47 - </span><span class="caption-text">Geração de Cubos de Dados.</span><a class="headerlink" href="#fig-products-cube-builder" title="Permalink to this image"></a></p>
</div>
</div>
<div class="section" id="composicao-temporal">
<h3>Composição Temporal<a class="headerlink" href="#composicao-temporal" title="Permalink to this headline"></a></h3>
<p>Os Cubos de Dados BDC podem ser categorizados em 2 tipos, identidade e compostos no tempo. A natureza de um cubo de dados identidade consiste em disponibilizar as imagens na data de aquisição original do dado. Funções de composição temporal podem ser aplicadas sobre os cubos identidade para gerar cubos compostos no tempo, também chamados de regulares. Isto é feito para reduzir a dimensionalidade temporal do dado, uma vez que cubos identidade podem apresentar observações que não são equidistantes no tempo.</p>
<p>3 funções de composição temporal estão disponíveis pelo BDC: ( <em>i</em> ) média, ( <em>ii</em> ) mediana, e ( <em>iii</em> ) stack. Estas funções operam sobre as observações válidas, ou seja, que não são detectadas como nuvens ou sombra de nuvens pelas bandas de qualidade, considerando a dimensão temporal e um passo de tempo, por exemplo 1 mês ou 16 dias. A composição temporal por média consiste em utilizar o valor médio obtido das observações. A composição temporal de Mediana consiste em utilizar o valor central das observações. A composição temporal por Stack consiste em uma abordagem de escolha de melhor pixel, em que a preferência destes é dada de acordo com a porção livre de nuvens e sombra de nuvens de sua imagem, por exemplo uma imagem com uma área de 5% coberta por nuvens é preferível para ser utilizada como imagem resultado ao ser comparada com uma imagem coberta 60% por nuvens. As funções de composição temporal mencionadas podem ser observadas na <a class="reference internal" href="#fig-products-compositing-functions"><span class="std std-numref">Figura 48</span></a>.</p>
<div class="align-center figure align-default" id="fig-products-compositing-functions">
<a class="reference internal image-reference" href="../../_images/compositing-function.png"><img alt="BDC Time Compositing Functions" src="../../_images/compositing-function.png" style="width: 720px;" /></a>
<p class="caption"><span class="caption-number">Figure 48 - </span><span class="caption-text">Funções de Composição Temporal adotadas pelo BDC.</span><a class="headerlink" href="#fig-products-compositing-functions" title="Permalink to this image"></a></p>
</div>
<p>Após a aplicação da Função de Composição Temporal, o Brazil Data Cube Builder também cálcula os índices espectrais NDVI e EVI usando o cubo gerado. Além disso, para cubos compostos no tempo, 3 bandas extras são geradas para verificação das características da composição. Essas bandas são <cite>CLEAROB</cite>, <cite>TOTALOB</cite> e <cite>PROVENANCE</cite>, e indicam a quantidade de observações livre de nuvens e sombra de nuvens dentro do período composto, o número total de observações para cada pixel, dentro do período composto e a data de acquisição (em dia juliano) do pixel resultante da composição.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="data-cube.html" class="btn btn-neutral float-left" title="Cubos de dados de Observação da Terra" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="data.html" class="btn btn-neutral float-right" title="Dados de Entrada" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, INPE.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-178140681-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-178140681-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>