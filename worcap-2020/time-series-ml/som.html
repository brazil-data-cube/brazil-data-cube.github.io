<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Avaliação da qualidade das amostras usando SOM clustering &mdash; Brazil Data Cube</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/table_styling.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/bdc.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Classificação de bricks e geração de mapas" href="class-brick.html" />
    <link rel="prev" title="Classificação de Séries Temporais" href="class-ts.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >
            <a href="../../index.html" class="icon icon-home"> Brazil Data Cube
            <img src="../../_static/logo-bdc.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Brazil Data Cube Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../products.html">BDC Data Products</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../applications.html">Services and Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../specifications.html">Specifications</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../worcap-2023.html">WORCAP 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../treinamento-2023.html">Treinamento PRODES 2023</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sbsr-2023.html">SBSR 2023 - Simpósio Brasileiro de Sensoriamento Remoto</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../treinamento-2022.html">Treinamento BDC 2022</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../worcap-2021.html">WorCAP 2021 - Introdução ao STAC e WTSS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ibge-2021.html">IBGE 2021 - Workshop Brazil Data Cube com IBGE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sbsr-2021.html">SBSR Interim 2021 - Simpósio Brasileiro de Sensoriamento Remoto</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../worcap-2020.html">WorCAP 2020 - Geoinformática com Aplicações de Machine Learning</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../course-info.html">Informações sobre o curso</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started.html">Preparação para o Curso</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro-geo.html">Introdução a Geoinformática e Sistemas de Informação Geográfica</a></li>
<li class="toctree-l2"><a class="reference internal" href="../access-view.html">Acesso e visualização de dados de observação da Terra do projeto Brasil Data Cube em linguagem Python</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../time-series-ml.html">Introdução a séries temporais de imagens de sensoriamento remoto e aplicações de Machine Learning</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="sits-intro.html">Introdução a séries temporais de imagens de satélites</a></li>
<li class="toctree-l3"><a class="reference internal" href="install-sits.html">Instalando o pacote <code class="docutils literal notranslate"><span class="pre">sits</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="access-ts.html">Acesso a Séries Temporais com o sits</a></li>
<li class="toctree-l3"><a class="reference internal" href="class-ts.html">Classificação de Séries Temporais</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Avaliação da qualidade das amostras usando SOM clustering</a></li>
<li class="toctree-l3"><a class="reference internal" href="class-brick.html">Classificação de bricks e geração de mapas</a></li>
<li class="toctree-l3"><a class="reference internal" href="accuracy.html">Estimação de acurácia</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../datascience-2020.html">CAP-394 - Introdução a Data Science (2020)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">General Information:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Brazil Data Cube</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../worcap-2020.html">WorCAP 2020 - Geoinformática com Aplicações de Machine Learning</a> &raquo;</li>
          <li><a href="../time-series-ml.html">Introdução a séries temporais de imagens de sensoriamento remoto e aplicações de Machine Learning</a> &raquo;</li>
          <li><a href="sits-intro.html">Introdução a séries temporais de imagens de satélites</a> &raquo;</li>
      <li>Avaliação da qualidade das amostras usando SOM clustering</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="class-ts.html" class="btn btn-neutral float-left" title="Classificação de Séries Temporais" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="class-brick.html" class="btn btn-neutral float-right" title="Classificação de bricks e geração de mapas" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="avaliacao-da-qualidade-das-amostras-usando-som-clustering">
<span id="time-series-ml-som"></span><h1>Avaliação da qualidade das amostras usando SOM clustering<a class="headerlink" href="#avaliacao-da-qualidade-das-amostras-usando-som-clustering" title="Permalink to this headline"></a></h1>
<div class="section" id="pratica-com-r-notebook">
<h2>Prática com R Notebook<a class="headerlink" href="#pratica-com-r-notebook" title="Permalink to this headline"></a></h2>
<div class="align-right figure align-default" id="time-series-ml-som-sits-clustering">
<a class="reference internal image-reference" href="../../_images/sits-clustering.png"><img alt="sits-clustering" src="../../_images/sits-clustering.png" style="width: 280px;" /></a>
</div>
<p>Neste <em>hands-on</em>, organizamos uma atividade prática no <code class="docutils literal notranslate"><span class="pre">sits</span></code> de acordo com o fluxograma apresentado ao lado. Nele, mostramos como é realizada a avaliação de amostras no <code class="docutils literal notranslate"><span class="pre">sits</span></code>. Aqui você aprenderá a:</p>
<ul class="simple">
<li><p>realizar a análise de clustering utilizando o SOM.</p></li>
<li><p>obter um conjunto de amostras de melhor qualidade.</p></li>
</ul>
<p>Notebook Kaggle: <a class="reference external" href="https://www.kaggle.com/lorenalves01/clustering-worcap/">https://www.kaggle.com/lorenalves01/clustering-worcap/</a></p>
</div>
<div class="section" id="introducao">
<h2>Introdução<a class="headerlink" href="#introducao" title="Permalink to this headline"></a></h2>
<p>Um dos desafios chave quando utilizamos amostras para treinar modelos de classificação supervisonada é avaliar a qualidade do modelo gerado.
Um conjunto de amostras ruidoso e imperfeito pode causar um efeito negativo no desempenho da classificação <a class="reference internal" href="#frenay-2013"><span class="std std-ref">(Frenay et al., 2013)</span></a>.
Aplicar um método de pré-processamento para melhoria da qualidade das amostras, onde a remoção de dados que foram rotulados erroneamente ou que tenha baixo poder discriminatório,
pode influenciar na geração de mapas classificados mais acurados. Neste módulo será abordado o problema de detecção de ruído de classe e melhoria da qualidade de
um conjunto de dados de séries temporais de imagem de satélite utilizando como abordagem principal o método de agrupamento de mapas auto-organizáveis, em inglês <em>Self-Organzing Maps</em> (SOM).</p>
</div>
<div class="section" id="efeitos-de-ruido-de-classe-na-classificacao">
<h2>Efeitos de ruído de classe na classificação<a class="headerlink" href="#efeitos-de-ruido-de-classe-na-classificacao" title="Permalink to this headline"></a></h2>
<p>Para ilustrar os efeitos que um conjunto de amostras com qualidade ruim  pode causar na geração de um modelo de aprendizado de máquina,
apresentamos o exemplo da <a class="reference internal" href="#time-series-ml-som-noisy"><span class="std std-numref">Figura 62</span></a>, onde a  classificação de uma série temporal de uso e cobertura da terra ao longo de 16 anos foi realizada.
O conjunto de dados utilizado para treinamento do modelo random forest possui amostras que foram rotuladas de forma errônea.</p>
<div class="align-center figure align-default" id="time-series-ml-som-noisy">
<a class="reference internal image-reference" href="../../_images/noisy.png"><img alt="Noisy" src="../../_images/noisy.png" style="width: 550px;" /></a>
<p class="caption"><span class="caption-number">Figure 62 - </span><span class="caption-text">Resultado de uma classificação ruim de uma série temporal utilizando o método random forest.</span><a class="headerlink" href="#time-series-ml-som-noisy" title="Permalink to this image"></a></p>
</div>
<p>Na classificação gerada pelo modelo random forest, na <a class="reference internal" href="#time-series-ml-som-noisy"><span class="std std-numref">Figura 62</span></a>, uma inconsistência é apresentada durante a trajetória da classificação apresentando o anos de 2007 e 2008 classificados como floresta logo em seguida de pasto.
Dado que em um ano uma floresta não se regenera, podemos notar a presença de um erro na classificação da série temporal para estes anos. Isto se deve ao fato de possuir amostras que deveriam ter sido rotuladas como pasto ou alum tipo de agricultura, no entanto elas foram rotuladas como floresta.</p>
<p>A <a class="reference internal" href="#time-series-ml-som-good"><span class="std std-numref">Figura 63</span></a> apresenta a classificação da mesma série temporal apresentada anteriormente, porém houve um pré-processamento no conjunto de dados utilizado para treinar o modelo do random forest  para a remoção de ruídos de clases.</p>
<div class="align-center figure align-default" id="time-series-ml-som-good">
<a class="reference internal image-reference" href="../../_images/good.png"><img alt="good" src="../../_images/good.png" style="width: 550px;" /></a>
<p class="caption"><span class="caption-number">Figure 63 - </span><span class="caption-text">Classificação da mesma série temporal após a remoção de amostras ruidosas.</span><a class="headerlink" href="#time-series-ml-som-good" title="Permalink to this image"></a></p>
</div>
<p>O metódo SOM no contexto do projeto Brazil Data Cube é utilizado  para avaliar a qualidade e a remoção de cada uma das amostras do conjunto de dados de treinamento.</p>
</div>
<div class="section" id="metodo-som-para-identificacao-de-ruido-de-classe">
<h2>Método SOM para identificação de ruído de classe<a class="headerlink" href="#metodo-som-para-identificacao-de-ruido-de-classe" title="Permalink to this headline"></a></h2>
<p>O método SOM é uma rede neural não supervisionada que mapeia um conjunto de dados de alta dimensionalidade em um de baixa dimensionalidade, geralmente uma grade bi-dimensional.
A <a class="reference internal" href="#time-series-ml-som-redesom"><span class="std std-numref">Figura 64</span></a> apresenta a estrutura da rede SOM. O espaço de saída da rede é composta por unidades chamadas neurônios.
Cada neurônio possui um vetor de pesos associados a ele, onde cada vetor de peso possui a mesma dimensão que o dado de entrada.
Geralmente, a inicialização do método pode ser realizada de forma aleatória e então a rede é treinada através de aprendizado competitivo.
A ideia principal do SOM é calcular a distância entre cada amostra do conjunto de dados e todos os neurônios afim/a fim de encontrar o neurônio que possui a menor distância.
O neurônio que possui a menor distância é chamado de melhor unidade de medida em inglês <em>Best matching unit</em> (BMU). O peso de uma BMU e de seus vizinhos devem ser atualizados para que
similaridade da vizinhança dos neurônios prevaleça <a class="reference internal" href="#kohonen-2001"><span class="std std-ref">Kohonen et al. (2001)</span></a>.</p>
<div class="align-center figure align-default" id="time-series-ml-som-redesom">
<a class="reference internal image-reference" href="../../_images/redesom.png"><img alt="redesom" src="../../_images/redesom.png" style="width: 550px;" /></a>
<p class="caption"><span class="caption-number">Figure 64 - </span><span class="caption-text">Estrutura da rede SOM. Fonte: <a class="reference internal" href="#santos-2020"><span class="std std-ref">(Santos et al, 2020)</span></a>.</span><a class="headerlink" href="#time-series-ml-som-redesom" title="Permalink to this image"></a></p>
</div>
<p>Após o treinamento da rede SOM, cada amostra está associada a neurônio, portanto os neurônios podem ser rotulados a partir da técnica de voto majoritário
Assim o mapa SOM é usado para avaliar a qualidade de cada elemento do conjunto de treinamento.
Cada neurônio será associado a uma distribuição de probabilidade discreta, a qual denominamos probabilidade condicional.
Neurônios mais homogêneos, aqueles com uma única classe de alta probabilidade, são compostos por amostras de boa qualidade.
Neurônios heterogêneos, aqueles com duas ou mais classes com probabilidade significativa, provavelmente contêm amostras ruidosas.
Além disso consideramos que a probabilidade da classe de neurônios (probabilidade condicional) não é a melhor medida de ruído de classe porque os vizinhos
de cada neurônio de um mapa SOM fornecem informações adicionais sobre a variabilidade intraclasse e interclasse.
Portanto, aplicamos a inferência bayesiana às vizinhanças do mapa SOM para melhorar a avaliação da qualidade de cada série temporal, chamamos a probabilidade que sofre influência
dos neurônios vizinhos de probabilidade posterior. Na <a class="reference internal" href="#time-series-ml-som-sombayes"><span class="std std-numref">Figura 65</span></a> o neurônio 3 pertence a Classe 2 porque 75% das amostras que foram associadas a este neurônio
pertecem a Classe 2. No entanto, todos os neurônios vizinhos pertecem a Classe 1, isto influência na confiabilidade das amostras associadas ao neurônio 3, fazendo com que a probabilidade posterior seja menor que condicional.</p>
<div class="align-center figure align-default" id="time-series-ml-som-sombayes">
<a class="reference internal image-reference" href="../../_images/sombayes.png"><img alt="sombayes" src="../../_images/sombayes.png" style="width: 550px;" /></a>
<p class="caption"><span class="caption-number">Figure 65 - </span><span class="caption-text">Aplicando a inferência bayesiana no neurônio 3</span><a class="headerlink" href="#time-series-ml-som-sombayes" title="Permalink to this image"></a></p>
</div>
<p>A tabela abaixo apresenta um exemplo da saída do método de qualidade de amostras.
As probabilidades condicional e posterior indicam o nível de confiabilidade delas realmente pertecerem a classe pasto dado o neurônio onde elas foram alocadas e a sua  vizinhança.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 20%" />
<col style="width: 34%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Id amostra</p></td>
<td><p>Classe</p></td>
<td><p>Prob. Condicional</p></td>
<td><p>Prob. Posterior</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>Pasto</p></td>
<td><p>100%</p></td>
<td><p>99.9%</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Pasto</p></td>
<td><p>38%</p></td>
<td><p>33%</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Pasto</p></td>
<td><p>70%</p></td>
<td><p>20%</p></td>
</tr>
</tbody>
</table>
<p>Para determinar se a amostra deve ser removida, mantida ou analisada, as probabilidades devem ser analisadas em conjunto.
A <a class="reference internal" href="#time-series-ml-som-decision"><span class="std std-numref">Figura 66</span></a> apresenta um fluxograma que indica qual decisão será tomada a partir dos limiares definidos para definir a qualidade do
conjunto de amostras.</p>
<div class="align-center figure align-default" id="time-series-ml-som-decision">
<a class="reference internal image-reference" href="../../_images/decision.png"><img alt="decision" src="../../_images/decision.png" style="width: 550px;" /></a>
<p class="caption"><span class="caption-number">Figure 66 - </span><span class="caption-text">Fluxogama de tomada de decisão.</span><a class="headerlink" href="#time-series-ml-som-decision" title="Permalink to this image"></a></p>
</div>
<p>Utilizando as amostras que foram ilustradas na tabela acima e os limiares apresentados na <a class="reference internal" href="#time-series-ml-som-decision"><span class="std std-numref">Figura 66</span></a>,
a amostra 1 deve ser mantida conjunto de dados, a amostra 2 é automaticamente removida do conjuntos de dados,
e a amostra 3 deve ser avalidada por especialistas para verificar se elas devem ser mantidas ou não conjunto de dados.</p>
<p>Devida a alta probabilidade condicional da amostra 3, a primeira hipótese é que um subconjunto de amostras de pasto pode conter padrões diferentes dos demais,
portanto, este subconjunto pode está mapeado longe de sua vizinhança do espaço de atributos do SOM, sendo assim, essas amostras devem ser mantidas no conjunto de dados.
A segunda hipótese é que este subconjunto de dados pode ruído de classe, logo, estas amostras devem ser removidas do conjunto de dados.</p>
</div>
<div class="section" id="referencias">
<h2>Referências<a class="headerlink" href="#referencias" title="Permalink to this headline"></a></h2>
<ul class="simple" id="frenay-2013">
<li><p>Frénay, B., and Verleysen, M. Classification in the presence of label noise: a survey. IEEE transactions on neural networks and learning systems, 25(5):845–869, (2013).</p></li>
</ul>
<ul class="simple" id="kohonen-2001">
<li><p>Kohonen,T., Schroeder M. R., and Huang, T. S. Self-Organizing Maps. Springer-Verlag New York, Inc., Secaucus, NJ, USA, 3rd edition, 2001.</p></li>
</ul>
<ul class="simple" id="santos-2017">
<li><p>Santos, Lorena A., et al. “Clustering Methods to Asses Land Cover Samples of MODIS Vegetation Indexes Time Series.” International Conference on Computational Science and Its Applications. Springer, Cham, 2017.</p></li>
</ul>
<ul class="simple" id="santos-2020">
<li><p>Santos, Lorena A., et al. “Quality control and class noise reduction of satellite image time series”. Manuscript submitted to ISPRS Journal of Photogrammetry and Remote Sensing, July, 2020.</p></li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="class-ts.html" class="btn btn-neutral float-left" title="Classificação de Séries Temporais" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="class-brick.html" class="btn btn-neutral float-right" title="Classificação de bricks e geração de mapas" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, INPE.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-178140681-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-178140681-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>